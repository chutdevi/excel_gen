SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,1 DM_TYPE
,DC.DM_01 01st
,DC.DM_02 02nd
,DC.DM_03 03rd
,DC.DM_04 04th
,DC.DM_05 05th
,DC.DM_06 06th
,DC.DM_07 07th
,DC.DM_08 08th
,DC.DM_09 09th
,DC.DM_10 10th
,DC.DM_11 11th
,DC.DM_12 12th
,DC.DM_13 13th
,DC.DM_14 14th
,DC.DM_15 15th
,DC.DM_16 16th
,DC.DM_17 17th
,DC.DM_18 18th
,DC.DM_19 19th
,DC.DM_20 20th
,DC.DM_21 21st
,DC.DM_22 22nd
,DC.DM_23 23rd
,DC.DM_24 24th
,DC.DM_25 25th
,DC.DM_26 26th
,DC.DM_27 27th
,DC.DM_28 28th
,DC.DM_29 29th
,DC.DM_30 30th
,DC.DM_31 31st


FROM 

DEMAND_CONVERT DC

UNION ALL


SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,2 DM_TYPE
,DC.PL_01 01st
,DC.PL_02 02nd
,DC.PL_03 03rd
,DC.PL_04 04th
,DC.PL_05 05th
,DC.PL_06 06th
,DC.PL_07 07th
,DC.PL_08 08th
,DC.PL_09 09th
,DC.PL_10 10th
,DC.PL_11 11th
,DC.PL_12 12th
,DC.PL_13 13th
,DC.PL_14 14th
,DC.PL_15 15th
,DC.PL_16 16th
,DC.PL_17 17th
,DC.PL_18 18th
,DC.PL_19 19th
,DC.PL_20 20th
,DC.PL_21 21st
,DC.PL_22 22nd
,DC.PL_23 23rd
,DC.PL_24 24th
,DC.PL_25 25th
,DC.PL_26 26th
,DC.PL_27 27th
,DC.PL_28 28th
,DC.PL_29 29th
,DC.PL_30 30th
,DC.PL_31 31st

FROM 

DEMAND_CONVERT DC


UNION ALL


SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,3 DM_TYPE
,DC.AC_01  01st
,DC.AC_02  02nd
,DC.AC_03  03rd
,DC.AC_04  04th
,DC.AC_05  05th
,DC.AC_06  06th
,DC.AC_07  07th
,DC.AC_08  08th
,DC.AC_09  09th
,DC.AC_10  10th
,DC.AC_11  11th
,DC.AC_12  12th
,DC.AC_13  13th
,DC.AC_14  14th
,DC.AC_15  15th
,DC.AC_16  16th
,DC.AC_17  17th
,DC.AC_18  18th
,DC.AC_19  19th
,DC.AC_20  20th
,DC.AC_21  21st
,DC.AC_22  22nd
,DC.AC_23  23rd
,DC.AC_24  24th
,DC.AC_25  25th
,DC.AC_26  26th
,DC.AC_27  27th
,DC.AC_28  28th
,DC.AC_29  29th
,DC.AC_30  30th
,DC.AC_31  31st

FROM 

DEMAND_CONVERT DC

UNION ALL


SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,4 DM_TYPE
,DC.AC_01 - DC.PL_01  01st
,DC.AC_02 - DC.PL_02  02nd
,DC.AC_03 - DC.PL_03  03rd
,DC.AC_04 - DC.PL_04  04th
,DC.AC_05 - DC.PL_05  05th
,DC.AC_06 - DC.PL_06  06th
,DC.AC_07 - DC.PL_07  07th
,DC.AC_08 - DC.PL_08  08th
,DC.AC_09 - DC.PL_09  09th
,DC.AC_10 - DC.PL_10  10th
,DC.AC_11 - DC.PL_11  11th
,DC.AC_12 - DC.PL_12  12th
,DC.AC_13 - DC.PL_13  13th
,DC.AC_14 - DC.PL_14  14th
,DC.AC_15 - DC.PL_15  15th
,DC.AC_16 - DC.PL_16  16th
,DC.AC_17 - DC.PL_17  17th
,DC.AC_18 - DC.PL_18  18th
,DC.AC_19 - DC.PL_19  19th
,DC.AC_20 - DC.PL_20  20th
,DC.AC_21 - DC.PL_21  21st
,DC.AC_22 - DC.PL_22  22nd
,DC.AC_23 - DC.PL_23  23rd
,DC.AC_24 - DC.PL_24  24th
,DC.AC_25 - DC.PL_25  25th
,DC.AC_26 - DC.PL_26  26th
,DC.AC_27 - DC.PL_27  27th
,DC.AC_28 - DC.PL_28  28th
,DC.AC_29 - DC.PL_29  29th
,DC.AC_30 - DC.PL_30  30th
,DC.AC_31 - DC.PL_31  31st

FROM 

DEMAND_CONVERT DC

UNION ALL

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,5 DM_TYPE
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '01' THEN  DS.ON_HAND END  01st
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '02' THEN  DS.ON_HAND END  02nd
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '03' THEN  DS.ON_HAND END  03rd
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '04' THEN  DS.ON_HAND END  04th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '05' THEN  DS.ON_HAND END  05th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '06' THEN  DS.ON_HAND END  06th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '07' THEN  DS.ON_HAND END  07th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '08' THEN  DS.ON_HAND END  08th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '09' THEN  DS.ON_HAND END  09th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '10' THEN  DS.ON_HAND END  10th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '11' THEN  DS.ON_HAND END  11th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '12' THEN  DS.ON_HAND END  12th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '13' THEN  DS.ON_HAND END  13th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '14' THEN  DS.ON_HAND END  14th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '15' THEN  DS.ON_HAND END  15th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '16' THEN  DS.ON_HAND END  16th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '17' THEN  DS.ON_HAND END  17th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '18' THEN  DS.ON_HAND END  18th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '19' THEN  DS.ON_HAND END  19th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '20' THEN  DS.ON_HAND END  20th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '21' THEN  DS.ON_HAND END  21st
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '22' THEN  DS.ON_HAND END  22nd
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '23' THEN  DS.ON_HAND END  23rd
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '24' THEN  DS.ON_HAND END  24th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '25' THEN  DS.ON_HAND END  25th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '26' THEN  DS.ON_HAND END  26th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '27' THEN  DS.ON_HAND END  27th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '28' THEN  DS.ON_HAND END  28th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '29' THEN  DS.ON_HAND END  29th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '30' THEN  DS.ON_HAND END  30th
,CASE WHEN DATE_FORMAT( CURDATE() - INTERVAL 1 DAY , '%d') = '31' THEN  DS.ON_HAND END  31st

FROM 

DEMAND_CONVERT DC

LEFT OUTER JOIN 

( SELECT * FROM DEMAND_STOCK  WHERE WH_CD IN ('K1MX', 'K2MX') ) DS

ON DC.ITEM_CD = DS.ITEM_CD AND DC.PLANT_CD = DS.PLANT_CD

UNION ALL 

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,6 DM_TYPE
,NULL  01st
,NULL  02nd
,NULL  03rd
,NULL  04th
,NULL  05th
,NULL  06th
,NULL  07th
,NULL  08th
,NULL  09th
,NULL  10th
,NULL  11th
,NULL  12th
,NULL  13th
,NULL  14th
,NULL  15th
,NULL  16th
,NULL  17th
,NULL  18th
,NULL  19th
,NULL  20th
,NULL  21st
,NULL  22nd
,NULL  23rd
,NULL  24th
,NULL  25th
,NULL  26th
,NULL  27th
,NULL  28th
,NULL  29th
,NULL  30th
,NULL  31st

FROM 

DEMAND_CONVERT DC

UNION ALL 

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,7 DM_TYPE
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_01 / DC.SNP) END  01st
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_02 / DC.SNP) END  02nd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_03 / DC.SNP) END  03rd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_04 / DC.SNP) END  04th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_05 / DC.SNP) END  05th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_06 / DC.SNP) END  06th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_07 / DC.SNP) END  07th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_08 / DC.SNP) END  08th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_09 / DC.SNP) END  09th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_10 / DC.SNP) END  10th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_11 / DC.SNP) END  11th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_12 / DC.SNP) END  12th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_13 / DC.SNP) END  13th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_14 / DC.SNP) END  14th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_15 / DC.SNP) END  15th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_16 / DC.SNP) END  16th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_17 / DC.SNP) END  17th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_18 / DC.SNP) END  18th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_19 / DC.SNP) END  19th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_20 / DC.SNP) END  20th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_21 / DC.SNP) END  21st
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_22 / DC.SNP) END  22nd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_23 / DC.SNP) END  23rd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_24 / DC.SNP) END  24th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_25 / DC.SNP) END  25th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_26 / DC.SNP) END  26th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_27 / DC.SNP) END  27th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_28 / DC.SNP) END  28th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_29 / DC.SNP) END  29th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_30 / DC.SNP) END  30th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.DM_31 / DC.SNP) END  31st

FROM 

DEMAND_CONVERT DC

UNION ALL 

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,8 DM_TYPE
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_01 / DC.SNP) END  01st
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_02 / DC.SNP) END  02nd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_03 / DC.SNP) END  03rd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_04 / DC.SNP) END  04th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_05 / DC.SNP) END  05th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_06 / DC.SNP) END  06th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_07 / DC.SNP) END  07th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_08 / DC.SNP) END  08th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_09 / DC.SNP) END  09th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_10 / DC.SNP) END  10th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_11 / DC.SNP) END  11th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_12 / DC.SNP) END  12th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_13 / DC.SNP) END  13th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_14 / DC.SNP) END  14th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_15 / DC.SNP) END  15th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_16 / DC.SNP) END  16th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_17 / DC.SNP) END  17th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_18 / DC.SNP) END  18th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_19 / DC.SNP) END  19th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_20 / DC.SNP) END  20th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_21 / DC.SNP) END  21st
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_22 / DC.SNP) END  22nd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_23 / DC.SNP) END  23rd
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_24 / DC.SNP) END  24th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_25 / DC.SNP) END  25th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_26 / DC.SNP) END  26th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_27 / DC.SNP) END  27th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_28 / DC.SNP) END  28th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_29 / DC.SNP) END  29th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_30 / DC.SNP) END  30th
,CASE WHEN DC.SNP > 10000 THEN NULL ELSE CEIL(DC.PL_31 / DC.SNP) END  31st

FROM 

DEMAND_CONVERT DC

UNION ALL 

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,9 DM_TYPE
,NULL  01st
,NULL  02nd
,NULL  03rd
,NULL  04th
,NULL  05th
,NULL  06th
,NULL  07th
,NULL  08th
,NULL  09th
,NULL  10th
,NULL  11th
,NULL  12th
,NULL  13th
,NULL  14th
,NULL  15th
,NULL  16th
,NULL  17th
,NULL  18th
,NULL  19th
,NULL  20th
,NULL  21st
,NULL  22nd
,NULL  23rd
,NULL  24th
,NULL  25th
,NULL  26th
,NULL  27th
,NULL  28th
,NULL  29th
,NULL  30th
,NULL  31st

FROM 

DEMAND_CONVERT DC

UNION ALL 

SELECT 
 
 DC.PARENT_SEC_CD
,DC.SOURCE_CD
,DC.SOURCE_NAME
,DC.ITEM_CD
,DC.ITEM_NAME
,DC.MODEL
,DC.SNP
,10 DM_TYPE
,NULL  01st
,NULL  02nd
,NULL  03rd
,NULL  04th
,NULL  05th
,NULL  06th
,NULL  07th
,NULL  08th
,NULL  09th
,NULL  10th
,NULL  11th
,NULL  12th
,NULL  13th
,NULL  14th
,NULL  15th
,NULL  16th
,NULL  17th
,NULL  18th
,NULL  19th
,NULL  20th
,NULL  21st
,NULL  22nd
,NULL  23rd
,NULL  24th
,NULL  25th
,NULL  26th
,NULL  27th
,NULL  28th
,NULL  29th
,NULL  30th
,NULL  31st

FROM 

DEMAND_CONVERT DC

ORDER BY 1,2,4,8